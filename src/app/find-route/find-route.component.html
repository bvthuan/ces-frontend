<div class="container">
  <div class="find-route">
    <form [formGroup]="findRouteForm" (ngSubmit)="onSubmit()" class="find-route-form">
      <div class="row">
        <div class="col-sm-6">
          <div class="form-group row">
            <label class="col-sm-3 col-form-label" for="username">Start*</label>
            <div class="col-sm-9">
              <p-autoComplete [inputStyleClass]="submitted && f.start.errors && 'is-invalid'" [forceSelection]="true" [suggestions]="filteredCities" (completeMethod)="search($event)" formControlName="start" field="name">
              </p-autoComplete>
              <div *ngIf="submitted && f.start.errors" class="invalid-feedback d-block">
                <div *ngIf="f.start.errors.required">Required</div>
              </div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-3 col-form-label" for="username">Destination*</label>
            <div class="col-sm-9">
              <p-autoComplete [inputStyleClass]="submitted && f.destination.errors && 'is-invalid'" [forceSelection]="true" [suggestions]="filteredCities" (completeMethod)="search($event)" formControlName="destination" field="name">
              </p-autoComplete>
              <div *ngIf="submitted && f.destination.errors" class="invalid-feedback d-block">
                <div *ngIf="f.destination.errors.required">Required</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-sm-6">
          <div class="form-group row">
            <label for="inputState" class="col-sm-3 col-form-label">Package type*</label>
            <div class="col-sm-9">
              <select id="inputState" class="form-control" formControlName="packageType" [ngClass]="{ 'is-invalid': submitted && f.packageType.errors }">
                <option selected value="">Choose...</option>
                <option [value]="package.code" *ngFor="let package of packageTypes">{{package.name}}</option>
              </select>
              <div *ngIf="submitted && f.packageType.errors" class="invalid-feedback d-block">
                <div *ngIf="f.packageType.errors.required">Required</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3">
          <div class="form-group row">
            <label for="weight" class="col-sm-3 col-form-label">Weight*</label>
            <div class="col-sm-9">
              <input type="text" formControlName="weight" class="form-control" id="weight" [ngClass]="{ 'is-invalid': submitted && f.weight.errors }" placeholder="kg..." />
              <div *ngIf="submitted && f.weight.errors" class="invalid-feedback d-block">
                <div *ngIf="f.weight.errors.required">Required</div>
                <div *ngIf="f.weight.errors.NaN">Number only</div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group row">
            <label for="width" class="col-sm-3 col-form-label">Width*</label>
            <div class="col-sm-9">
              <input type="text" formControlName="width" class="form-control" id="width" [ngClass]="{ 'is-invalid': submitted && f.width.errors }" placeholder="cm...">
              <div *ngIf="submitted && f.width.errors" class="invalid-feedback d-block">
                <div *ngIf="f.width.errors.required">Required</div>
                <div *ngIf="f.width.errors.NaN">Number only</div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group row">
            <label for="height" class="col-sm-3 col-form-label">Height*</label>
            <div class="col-sm-9">
              <input type="text" formControlName="height" class="form-control" id="height" [ngClass]="{ 'is-invalid': submitted && f.height.errors }" placeholder="cm...">
              <div *ngIf="submitted && f.height.errors" class="invalid-feedback d-block">
                <div *ngIf="f.height.errors.required">Required</div>
                <div *ngIf="f.height.errors.NaN">Number only</div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group row">
            <label for="length" class="col-sm-3 col-form-label">Length*</label>
            <div class="col-sm-9">
              <input type="text" formControlName="length" class="form-control" id="length" [ngClass]="{ 'is-invalid': submitted && f.length.errors }" placeholder="cm...">
              <div *ngIf="submitted && f.length.errors" class="invalid-feedback d-block">
                <div *ngIf="f.length.errors.required">Required</div>
                <div *ngIf="f.length.errors.NaN">Number only</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row form-group">
        <div class="col-sm-6">
          <div class="transport type">
            <div class="form-check">
              <input class="form-check-input" type="radio" formControlName="transportType" id="cheapest" value="1" checked>
              <label class="form-check-label" for="cheapest">
                  Cheapest route
                </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" formControlName="transportType" id="fastest" value="0">
              <label class="form-check-label" for="fastest">
                  Fastest route
                </label>
            </div>
          </div>
        </div>
      </div>

      <div class="form-group text-center" style="margin-top: 20px;">
        <button [disabled]="loading" class="btn btn-primary btn-login find-button">Find</button>
        <img *ngIf="loading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="
        />
      </div>
      <div *ngIf="error" class="alert alert-danger">{{error}}</div>

      <div class="routes" *ngIf="!error">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th scope="col" width="50">No</th>
              <th scope="col">Start</th>
              <th scope="col">Destination</th>
              <th scope="col" width="135">Transportation</th>
              <th scope="col" width="125">Start date</th>
              <th scope="col" width="125">Time (hour)</th>
              <th scope="col" width="70">Price</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="!route.routes.length">
              <tr *ngIf="!loading">
                <td colspan="7" class="text-center no-result">No results</td>
              </tr>
            </ng-container>
            <ng-container *ngIf="route.routes.length">
              <tr *ngFor="let route of route.routes; let i = index">
                <th scope="row">{{i+1}}</th>
                <td>{{getCityName(route.start)}}</td>
                <td>{{getCityName(route.destination)}}</td>
                <td>{{route.transportation}}</td>
                <td>{{route.startDate | date: 'dd/MM/yyyy'}}</td>
                <td>{{route.time}}</td>
                <td>${{route.price}}</td>
              </tr>
            </ng-container>
          </tbody>
        </table>

        <ul class="list-group mb-3 float-right" *ngIf="route.routes.length">
          <li class="list-group-item d-flex justify-content-between lh-condensed">
            <div>
              <p class="my-0">Total time(hours)</p>
            </div>
            <span class="text-muted">{{route.totalTime}}</span>
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <div>
              <h6 class="my-0">Total Price(USD)</h6>
            </div>
            <span class="text-muted"><strong>{{route.totalPrice}}</strong></span>
          </li>
        </ul>
      </div>
    </form>
  </div>
</div>